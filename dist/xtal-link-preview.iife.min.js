!function(){function t(t){let e=t.is;customElements.get(e)?console.warn("Already registered "+e):customElements.define(e,t)}const e="disabled";const n="href",s="service-url",i="fetch-in-progress",r="fetch-complete",a="title";class o extends(function(t){return class extends t{constructor(){super(...arguments),this._evCount={}}static get observedAttributes(){return[e]}get disabled(){return this._disabled}set disabled(t){this.attr(e,t,"")}attr(t,e,n){this[(e?"set":"remove")+"Attribute"](t,n||e)}to$(t){const e=t%2;return(t-e)/2+"-"+e}incAttr(t){const e=this._evCount;t in e?e[t]++:e[t]=0,this.attr("data-"+t,this.to$(e[t]))}attributeChangedCallback(t,n,s){switch(t){case e:this._disabled=null!==s}}de(t,e,n=!1){const s=t+(n?"":"-changed"),i=new CustomEvent(s,{detail:e,bubbles:!0,composed:!1});return this.dispatchEvent(i),this.incAttr(s),i}_upgradeProperties(t){t.forEach(t=>{if(this.hasOwnProperty(t)){let e=this[t];delete this[t],this[t]=e}})}}}(HTMLElement)){constructor(){super(...arguments),this._serviceUrl="https://cors-anywhere.herokuapp.com/",this._connected=!1}get serviceUrl(){return this._serviceUrl}set serviceUrl(t){this.attr("service-url",t)}get href(){return this._href}set href(t){this.attr("href",t)}get fetchInProgress(){return this._fetchInProgress}set fetchInProgress(t){this._fetchInProgress=t,this.attr(i,t,""),this.de(i,{value:t})}get fetchComplete(){return this._fetchComplete}set fetchComplete(t){this._fetchComplete=t,this.attr(r,t,""),this.de(r,{value:t})}get title(){return this._title}set title(t){this._title=t,this.attr(a,t)}static get observedAttributes(){return super.observedAttributes.concat([n,s])}attributeChangedCallback(t,e,n){switch(super.attributeChangedCallback(t,e,n),t){case"href":this._href=n;break;case"service-url":this._serviceUrl=n}this.onPropsChange()}connectedCallback(){this._upgradeProperties(["disabled",n,"serviceUrl"]),this._connected=!0,this.de("connected",{value:this.href}),this.onPropsChange()}set abort(t){this._controller&&this._controller.abort()}doFetch(){const t=this.calculateURL();if(this._previousURL===t)return this.fetchComplete=!1,void(this.fetchComplete=!0);this._previousURL=t,this.title="Loading...",this.fetchInProgress=!0,this.fetchComplete=!1;let e=null;AbortController&&(this._controller=new AbortController,e=this._controller.signal),fetch(t,{signal:e}).then(t=>{this.fetchInProgress=!1,this.processResponse(t),this.fetchComplete=!0}).catch(t=>{"AbortError"===t.name&&(console.log("Fetch aborted"),delete this._previousURL)})}calculateURL(t=0){let e=this._href;if(t){const n=e.split("/");-1===t&&(e=[n[0],n[1],n[2]].join("/"))}return this._serviceUrl+e}}const h="preview",l="image-width";class c extends o{constructor(){super(),this._serviceUrl="https://cors-anywhere.herokuapp.com/",this._preview=!1,this._imageWidth=150,this.style.display="block"}static get is(){return"xtal-link-preview-base"}get preview(){return this._preview}set preview(t){this.attr(h,t,"")}get imageWidth(){return this._imageWidth}set imageWidth(t){this.attr(l,t.toString())}static get observedAttributes(){return super.observedAttributes.concat([h,l])}connectedCallback(){this._upgradeProperties([h,"imageWidth"]),super.connectedCallback()}calculateURL(){return this._serviceUrl+this._href}onPropsChange(){this._connected&&this._preview&&!this.disabled&&this._href&&this._serviceUrl&&this.doFetch()}getMetaContent(t,e,n){let s=function(t,e){return[].slice.call((e||this).querySelectorAll(t))}("meta["+e+'="'+n+'"]',t).filter(t=>t.content);return s&&s.length>0?s[0].content:null}getAbsPath(t){let e=t,n=this._href;const s=n.indexOf("#");if(s>-1&&(n=n.substr(0,s)),!t.startsWith("http")&&!t.startsWith("data"))if(t.startsWith("/"))e=n.split("/").slice(0,3).join("/")+t;else{const s=n.endsWith("/")?"":"/";e.startsWith("/")&&e.replace("/",""),e=n+s+t}return e}processResponse(t){t.text().then(t=>{this.fetchInProgress=!1;const e=(new DOMParser).parseFromString(t,"text/html");let n=this.getMetaContent(e,"name","twitter:image:src");if(n||(n=this.getMetaContent(e,"name","twitter:image")),n||(n=this.getMetaContent(e,"property","og:image")),!n){const t=e.querySelector("img");t&&(n=t.getAttribute("src"))}if(!n){const t=e.querySelector('link[rel="icon"]');t&&(n=t.getAttribute("href"))}n&&(n=this.getAbsPath(n));let s=e.querySelector("title");s&&(this.title=s.innerHTML);let i=this.getMetaContent(e,"name","description");i?this.title=this.title.replace(i,""):i="",this.setInnerHTML(`\n                <div>\n                    <details open>\n                        <summary>${this.title}</summary>\n                        <p>${i}</p>\n                    </details>\n                    <img alt="${this.title}" width="${this._imageWidth}" src="${n}"/>\n                </div>\n            `),this.fetchComplete=!0})}setInnerHTML(t){this.innerHTML=t}attributeChangedCallback(t,e,n){switch(t){case"preview":this._preview=null!==n,this._preview||(this.abort=!0)}super.attributeChangedCallback(t,e,n)}}t(c);const d=document.createElement("template");d.innerHTML='\n<slot name="loading"></slot>\n<main></main>\n<style>\n:host{\n    display: block;\n}\nslot {\n    height:100%;\n    width:100%;\n    display:flex;\n    flex-direction:column;\n    align-items:center;\n    justify-content: center;\n}\nmain {\n    /* Add shadows to create the "card" effect */\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);\n    transition: 0.3s;\n    height: 100%;\n    width: 100%;\n    display:flex;\n    flex-direction:column;\n    align-items: center;\n    justify-content: center;\n}\n\n/* On mouse-over, add a deeper shadow */\nmain:hover {\n    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);\n}\n\nmain>div {\n    display: flex;\n    height: 100%;\n    padding: 5px;\n}\nmain img {\n    object-fit: scale-down;\n}\n@media (min-width: 800px) {\n    main>div {\n        flex-direction: row-reverse;\n        justify-content: space-around;\n    }\n    main img {\n        align-self: stretch;\n        filter: drop-shadow(0px 0px 1px rgba(0,0,0,.3))\n        drop-shadow(0px 0px 10px rgba(0,0,0,.3));\n    }\n\n}\n\n@media (max-width: 800px) {\n    main>div {\n        flex-direction: column-reverse;\n        align-items: center;\n        justify-content: center;\n    }\n    main img {\n        border: 1px solid #ccc;\n    }\n\n}\n\n      main>div>details>summary{\n        list-style:none;\n      }\n\n      main>div>details > summary::-webkit-details-marker {\n        display: none;\n      }\n\n\n      main>div>details>summary {\n        margin-top: 5px;\n        font-weight: 800;\n      }\n\n      main>div>details p {\n        text-align: left;\n        margin-left: 5px;\n      }\n</style>\n';t(class extends c{static get is(){return"xtal-link-preview"}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(d.content.cloneNode(!0))}setInnerHTML(t){this.shadowRoot.querySelector("main").innerHTML=t,this.shadowRoot.querySelector("slot").style.display="none"}})}();